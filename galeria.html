<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Galería – Argentex</title>
  <link rel="icon" type="image/png" href="favicon.png" />
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Michroma&family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="style.css"/>

  <style>
    /* CORRECCIÓN: Espacio para que el header no tape el título */
    .gallery-wrap { 
        padding: 140px 2rem 4rem 2rem; /* 140px empuja el contenido debajo del header */
        max-width: 1200px; 
        margin: 0 auto; 
        min-height: 80vh; 
    }

    .gallery-head { text-align: center; margin-bottom: 3rem; }
    
    .gallery-head h1 { 
        font-family: 'Michroma', sans-serif; 
        color: var(--color-acento); 
        font-size: clamp(1.6rem, 3vw, 2.4rem); 
        margin-bottom: 1rem;
    }
    
    .gallery-head p { 
        color: var(--color-texto); 
        opacity: 0.8;
    }

    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 20px;
    }

    .card {
        background: var(--color-secundario);
        border: 1px solid rgba(255,255,255,0.05);
        border-radius: 12px;
        overflow: hidden;
        cursor: pointer;
        transition: transform 0.3s ease, border-color 0.3s ease;
    }

    .card:hover {
        transform: translateY(-5px);
        border-color: var(--color-acento);
    }

    .card img {
        width: 100%;
        aspect-ratio: 1/1;
        object-fit: cover;
        display: block;
    }

    /* LIGHTBOX (Zoom de imagen) */
    .lb {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.95);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 3000;
        backdrop-filter: blur(10px);
    }
    .lb.open { display: flex; }
    .lb-content { position: relative; max-width: 90vw; }
    .lb-content img { max-width: 100%; max-height: 80vh; border-radius: 8px; }
    
    .lb-close {
        position: absolute;
        top: -50px;
        right: 0;
        color: white;
        font-size: 2.5rem;
        background: none;
        border: none;
        cursor: pointer;
    }

    @media (max-width: 768px) {
        .gallery-wrap { padding-top: 110px; }
    }
  </style>
</head>
<body>

  <header id="main-header"></header>

  <main class="gallery-wrap">
    <div class="gallery-head">
      <h1>Galería de Proyectos</h1>
      <p>Explorá nuestras impresiones y diseños 3D personalizados.</p>
    </div>

    <div class="grid" id="gallery-grid">
      </div>
  </main>

  <div class="lb" id="lightbox">
    <div class="lb-content">
      <button class="lb-close">&times;</button>
      <img id="lb-img" src="" alt="Zoom">
    </div>
  </div>

  <footer id="main-footer"></footer>

  <script>
    // Cargar Header y Footer
    async function loadComponent(id, file) {
      try {
        const res = await fetch(file);
        document.getElementById(id).innerHTML = await res.text();
      } catch (e) { console.error(e); }
    }
    loadComponent('main-header', 'header.html');
    loadComponent('main-footer', 'footer.html');

    // Cargar imágenes de la carpeta 'files_galeria'
    (async function(){
      const user = "argentex2000-byte";
      const repo = "Argentex";
      const folder = "files_galeria"; 
      const grid = document.getElementById('gallery-grid');

      try {
        const res = await fetch(`https://api.github.com/repos/${user}/${repo}/contents/${folder}`);
        const files = await res.json();
        const images = files.filter(f => /\.(png|jpe?g|webp)$/i.test(f.name));

        images.forEach(f => {
          const card = document.createElement('div');
          card.className = 'card';
          card.innerHTML = `<img src="${f.download_url}" alt="Trabajo Argentex">`;
          card.onclick = () => {
            document.getElementById('lb-img').src = f.download_url;
            document.getElementById('lightbox').classList.add('open');
          };
          grid.appendChild(card);
        });
      } catch(e) {
        grid.innerHTML = "<p>Error al cargar las imágenes.</p>";
      }
    })();

    // Cerrar Zoom
    document.querySelector('.lb-close').onclick = () => {
      document.getElementById('lightbox').classList.remove('open');
    };

    // Ocultar Header al bajar
    let lastScrollTop = 0;
    window.addEventListener('scroll', function() {
      const header = document.querySelector('header');
      if (!header) return;
      let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      if (scrollTop > lastScrollTop && scrollTop > 100) {
        header.classList.add('header-hidden');
      } else {
        header.classList.remove('header-hidden');
      }
      lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
    });
  </script>
</body>
</html>
