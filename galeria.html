<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Galería – Argentex</title>
  <link rel="icon" type="image/png" href="favicon.png" />
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Michroma&family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="style.css"/>

  <style>
    .gallery-wrap { 
        padding: 4rem 2rem; 
        max-width: 1200px; 
        margin: 0 auto; 
        min-height: 80vh; 
    }

    .gallery-head { text-align: center; margin-bottom: 3rem; }
    
    .gallery-head h1 { 
        font-family: 'Michroma', sans-serif; 
        color: var(--brand-cyan); 
        font-size: clamp(1.6rem, 3vw, 2.4rem); 
        margin-bottom: 1rem;
    }
    
    .gallery-head p { 
        color: var(--brand-gray); 
        font-family: 'Montserrat', sans-serif;
    }

    /* GRID RESPONSIVO */
    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
    }

    /* TARJETA */
    .g-item {
      display: flex;
      flex-direction: column;
      background: var(--color-neutro);
      border-radius: 12px;
      overflow: hidden; 
      box-shadow: 0 6px 20px rgba(0,0,0, 0.5);
      border: 1px solid #222;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .g-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(63, 181, 247, 0.15); 
    }

    /* IMAGEN CUADRADA 800x800 */
    .img-wrapper {
      width: 100%;
      aspect-ratio: 1 / 1;
      overflow: hidden;
      background-color: #0a0a0a;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: zoom-in;
    }

    .img-wrapper img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      display: block;
      transition: transform 0.4s ease;
    }

    .info-content {
      padding: 1.5rem;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }

    .info-content h3 {
      font-family: 'Michroma', sans-serif;
      font-size: 1rem;
      color: var(--brand-cyan);
      margin-bottom: 0.5rem;
      letter-spacing: 0.5px;
      font-weight: 400;
    }

    .desc {
      font-size: 0.9rem;
      color: #ccc;
      margin-bottom: 1.2rem;
      line-height: 1.4;
      font-family: 'Montserrat', sans-serif;
    }

    /* ESPECIFICACIONES */
    .specs-grid {
      margin-top: auto;
      border-top: 1px solid #333;
      padding-top: 1rem;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .spec-item {
      flex: 1; 
      display: flex;
      flex-direction: column;
    }

    .spec-item.full-width {
      flex: 100%; 
      margin-top: 5px;
    }

    .label {
      font-size: 0.65rem;
      color: #888;
      text-transform: uppercase;
      margin-bottom: 2px;
      font-weight: 700;
    }

    .value {
      font-family: 'Michroma', sans-serif;
      font-size: 0.75rem;
      color: var(--brand-orange); 
    }

    .measures {
      color: var(--brand-white); 
      letter-spacing: 1px;
    }

    /* LIGHTBOX */
    .lightbox {
      position: fixed; inset: 0; 
      background: rgba(0,0,0, 0.95);
      display: none; align-items: center; justify-content: center;
      z-index: 2000; padding: 1rem;
      backdrop-filter: blur(5px);
    }
    .lightbox.open { display: flex; }
    .lightbox img { max-width: 95vw; max-height: 85vh; object-fit: contain; border-radius: 4px; }
    
    .lb-close, .lb-prev, .lb-next {
      position: absolute; top: 50%; transform: translateY(-50%);
      width: 50px; height: 50px; border-radius: 50%; border: none;
      background: rgba(255,255,255,0.1); 
      color: var(--brand-white); font-size: 24px;
      display: grid; place-items: center; cursor: pointer;
    }
    .lb-close { top: 20px; right: 20px; transform: none; background: transparent; font-size: 40px;}
    .lb-prev { left: 20px; }
    .lb-next { right: 20px; }
  </style>
</head>
<body>

  <header id="main-header"></header>

  <main class="gallery-wrap">
    <div class="gallery-head">
      <h1>Galería de Trabajos</h1>
      <p>Nuestros proyectos de impresión 3D más recientes.</p>
    </div>

    <div id="grid" class="gallery-grid">
      <p style="text-align: center; color: #888;">Cargando trabajos...</p>
    </div>
  </main>

  <footer id="main-footer"></footer>

  <div id="lightbox" class="lightbox">
    <button class="lb-close">✕</button>
    <button class="lb-prev">‹</button>
    <img id="lb-img" alt="">
    <button class="lb-next">›</button>
  </div>

  <script>
    // --- 1. CARGADOR DE COMPONENTES GLOBALES ---
    async function loadComponent(id, file) {
      try {
        const res = await fetch(file);
        document.getElementById(id).innerHTML = await res.text();
      } catch (e) { console.error("Error cargando " + file, e); }
    }
    loadComponent('main-header', 'header.html');
    loadComponent('main-footer', 'footer.html');

    // --- 2. LÓGICA DE LA GALERÍA (JSON) ---
    (async function(){
      const username = "argentex2000-byte";
      const repo     = "Argentex";
      const folder   = "files_galeria"; 
      
      const imgBaseUrl  = `https://raw.githubusercontent.com/${username}/${repo}/main/${folder}/`;
      const dataUrl     = `https://raw.githubusercontent.com/${username}/${repo}/main/${folder}/datos.json`;

      const grid = document.getElementById('grid');
      const list = []; 

      try {
          const res = await fetch(dataUrl);
          if (!res.ok) throw new Error("Error al cargar JSON");
          const productos = await res.json();

          grid.innerHTML = "";

          productos.forEach(prod => {
            const src = imgBaseUrl + prod.Archivo;
            list.push(src); 

            const article = document.createElement('article');
            article.className = 'g-item'; 
            
            article.innerHTML = `
              <div class="img-wrapper">
                <img src="${src}" alt="${prod.Título || 'Trabajo'}" loading="lazy">
              </div>
              <div class="info-content">
                <h3>${prod.Título || "Sin Título"}</h3>
                <p class="desc">${prod.Descripción || ""}</p>
                <div class="specs-grid">
                  <div class="spec-item">
                      <span class="label">Material</span>
                      <span class="value">${prod.Material || '-'}</span>
                  </div>
                  <div class="spec-item">
                      <span class="label">Color</span>
                      <span class="value">${prod.Color || '-'}</span>
                  </div>
                  <div class="spec-item full-width">
                      <span class="label">Dimensiones (L x A x Alt)</span>
                      <span class="value measures">
                          ${prod.Dimensiones?.Largo || '0'} x ${prod.Dimensiones?.Ancho || '0'} x ${prod.Dimensiones?.Alto || '0'}
                      </span>
                  </div>
                </div>
              </div>
            `;
            
            article.querySelector('.img-wrapper').onclick = () => openLightbox(src);
            grid.appendChild(article);
          });

      } catch (e) {
          grid.innerHTML = "<p style='color:red;'>Error cargando la galería.</p>";
      }

      // --- 3. LÓGICA DEL LIGHTBOX ---
      const lb = document.getElementById('lightbox');
      const lbImg = document.getElementById('lb-img');
      let idx = 0;

      function openLightbox(src){ idx = list.indexOf(src); lbImg.src = src; lb.classList.add('open'); }
      function closeLightbox(){ lb.classList.remove('open'); lbImg.src = ""; }
      function step(d){ idx = (idx + d + list.length) % list.length; lbImg.src = list[idx]; }

      lb.querySelector('.lb-close').onclick = closeLightbox;
      lb.querySelector('.lb-prev').onclick = () => step(-1);
      lb.querySelector('.lb-next').onclick = () => step(1);
      lb.onclick = (e) => { if(e.target === lb) closeLightbox(); };
    })();
  </script>
</body>
</html>
